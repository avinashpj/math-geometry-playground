<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Phyllotaxis</title>
    <style>
        * {padding: 0; margin: 0}
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.7.0/pixi.min.js"></script>
</head>
<body>
    <script type="text/javascript">

        // create application
        let app = new PIXI.Application({backgroundColor: 0x333333, antialias: true});
        document.body.appendChild(app.view);
        
        // create shape (graphics)
        let graphics = new PIXI.Graphics();
        app.stage.addChild(graphics);
        graphics.position.set(400, 300);
        
        // convert degrees to radians
        const deg2rad = Math.PI / 180;
        
        // convert the golden angle to radians
        const goldenAngle = 137.5 * deg2rad;
        
        // scaling parameter
        const c = 8;
        
        // is the ordering number of a floret, counting outward from the center
        let n = 0;
        
        app.ticker.add(function(delta) {
            // is the angle between a reference direction and the position vector
            // of the nth floret in a polar coordinate system originating at
            // the center of the capitulum. It follows that the divergence angle
            // between the position vectors of any two successive florets is
            // constant, α = 137.5◦
            let a = n * goldenAngle;
            
            // is the distance between the center of the capitulum and the
            // center of the nth floret, given a constant scaling parameter c
            let r = c * Math.sqrt(n);
            
            // x and y position
            let x = r * Math.cos(a);
            let y = r * Math.sin(a);
            
            // get the color
            let color = getColor(n);
            
            // draw a circle
            graphics.beginFill(color);
            graphics.drawCircle(x, y, 4);
            
            // increase n
            n++;
        });
        
        /**
         * This function return a color running to red to blue.
         * @param   {number} value A crescent value
         * @returns {number} An integer color value
         */
        function getColor (value) {
            let r, g, b;
            value %= 1536;
            if (value < 256) {
                r = 255;
                g = value % 256;
                b = 0;
            } else if (value < 512) {
                r = 255 - value % 256;
                g = 255;
                b = 0;
            } else if (value < 768) {
                r = 0;
                g = 255;
                b = value % 256;
            } else if (value < 1024) {
                r = 0;
                g = 255 - value % 256;
                b = 255;
            } else if (value < 1280) {
                r = value % 256;
                g = 0;
                b = 255;
            } else if (value < 1536) {
                r = 255;
                g = 0;
                b = 255 - value % 256;
            }
            return (r << 16) + (g << 8) + (b); // red << 16 + green << 16 + blue;
        }
    </script>
</body>
</html>